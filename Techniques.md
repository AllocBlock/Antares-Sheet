# 一些还比较有趣的技术/算法
## 编辑器的设计
- 分为3层
  - 用户操作（如点击按钮、输入文字、快捷键）：Editor
  - 实际操作命令，安全（不会破坏曲谱树约束）（如修改文本、添加和弦/下划线），提供撤销：EditorCore
  - 底层对曲谱树的编辑，不安全（编辑内容、添加子节点、替换节点）：NodeUtils
- 撤销、重做的支持
  - 由于数据量不大，可以直接存储每个版本的完全拷贝
  - AtomOperation，避免重复记录
    - 类似Disposable的设计，自动释放，防止中途退出的导致计数器错误